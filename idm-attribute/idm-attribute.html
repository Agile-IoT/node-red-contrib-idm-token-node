<!--
Copyright (C) 2017 FBK, ATOS.
All rights reserved. This program and the accompanying materials
are made available under the terms of the Eclipse Public License v1.0
which accompanies this distribution, and is available at
http://www.eclipse.org/legal/epl-v10.html

Contributors:
    FBK, ATOS - initial API and implementation
-->
<script type="text/javascript">
    RED.nodes.registerType('idm-attribute',{
        category: 'agile',
        color: '#d19300',
        defaults: {
          name: {value:""},
          idm :{value: "http://agile-security:3000"},
          name: {value:"id"},
          property: {value:"attribute"},
          entity_id: {value :""},
          entity_type : {value: ""},
          attribute : {value: ""},
          destination_property : {value: ""}
        },
        inputs:1,
        outputs:1,
        icon: "file.png",
        label: function() {
            return this.name||"idm-attribute";
        }
    });
</script>

<script type="text/x-red" data-template-name="idm-attribute">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
    <div class="form-row">
    <label for="node-input-idm"><i class="icon-tag"></i>Idm location</label>
    <input type="text" id="node-input-idm">
    </div>
    <div class="form-row">
    <label for="node-input-entity_id"><i class="icon-tag"></i>Entity id</label>
    <input type="text" id="node-input-entity_id">
    </div>
    <div class="form-row">
    <label for="node-input-entity_type"><i class="icon-tag"></i>Entity type</label>
    <input type="text" id="node-input-entity_type">
    </div>
    <div class="form-row">
    <label for="node-input-attribute"><i class="icon-tag"></i>Attribute</label>
    <input type="text" id="node-input-attribute">
    </div>
    <div class="form-row">
    <label for="node-input-destination_property"><i class="icon-tag"></i>Destination </label>
    <input type="text" id="node-input-destination_property">
    </div>
</script>

<script type="text/x-red" data-help-name="idm-attribute">
<p>Node bringing attribute information from AGILE IDM</p>
 <b>Inputs</b>
 <p><code>msg.token</code>: This property can be obtained by placing the idm-token node before this one.</p>
 <p><code>msg.entity_id</code>: This message property specifies the entity id</p>
 <p><code>msg.entity_type</code>: This message property specifies the entity type, e.g. user, client, sensor, etc.</p></p>
 <p><code>msg.attribute</code>: This message property specifies the entity attribute to be read, e.g. id, credentials.dropbox, etc.</p></p>
 <p><code>msg.destination_property</code>: Once the node has processed the information for the entity, it will place in msg[msg.destination_property] the result. If no value is provided, it will be placed under msg.entity_attribute</p>
 <b>Outputs</b>
     msg[msg.destination_property] or msg.entity_attribute (if no destination_property was found) contain the entity attribute information

</script>
